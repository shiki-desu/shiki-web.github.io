"use strict";(self["webpackChunkshiki_web"]=self["webpackChunkshiki_web"]||[]).push([[5738],{5644:function(e,l,a){var n=a(58788),t=a(51137),o=a(20641),d=a(560),r=a(55780),s=a(50214),c=a(98463),u=a(5860),i=a(37820),v=a(50953),y=a(51636),p=a(47036),h=a(57646),K=a(11207),g=a(58777),f=a(11926),k=a(30573);const N=10;l.A=(0,o.pM)({compatConfig:{MODE:3},name:"Tree",inheritAttrs:!1,props:(0,y.A)((0,p.DP)(),{prefixCls:"vc-tree",showLine:!1,showIcon:!0,selectable:!0,multiple:!1,checkable:!1,disabled:!1,checkStrictly:!1,draggable:!1,expandAction:!1,defaultExpandParent:!0,autoExpandParent:!1,defaultExpandAll:!1,defaultExpandedKeys:[],defaultCheckedKeys:[],defaultSelectedKeys:[],dropIndicatorRender:i.A,allowDrop:()=>!0}),setup(e,l){let{attrs:a,slots:i,expose:y}=l;const p=(0,v.IJ)(!1);let A={};const E=(0,v.IJ)(),x=(0,v.IJ)([]),C=(0,v.IJ)([]),b=(0,v.IJ)([]),w=(0,v.IJ)([]),D=(0,v.IJ)([]),m=(0,v.IJ)([]),T={},P=(0,v.Kh)({draggingNodeKey:null,dragChildrenKeys:[],dropTargetKey:null,dropPosition:null,dropContainerKey:null,dropLevelOffset:null,dropTargetPos:null,dropAllowed:!0,dragOverNodeKey:null}),O=(0,v.IJ)([]);(0,o.wB)([()=>e.treeData,()=>e.children],()=>{O.value=void 0!==e.treeData?e.treeData.slice():(0,s.vH)((0,v.ux)(e.children))},{immediate:!0,deep:!0});const S=(0,v.IJ)({}),I=(0,v.IJ)(!1),L=(0,v.IJ)(null),W=(0,v.IJ)(!1),B=(0,o.EW)(()=>(0,s.AZ)(e.fieldNames)),$=(0,v.IJ)();let J=null,M=null,j=null;const H=(0,o.EW)(()=>({expandedKeysSet:R.value,selectedKeysSet:F.value,loadedKeysSet:G.value,loadingKeysSet:_.value,checkedKeysSet:U.value,halfCheckedKeysSet:Y.value,dragOverNodeKey:P.dragOverNodeKey,dropPosition:P.dropPosition,keyEntities:S.value})),R=(0,o.EW)(()=>new Set(m.value)),F=(0,o.EW)(()=>new Set(x.value)),G=(0,o.EW)(()=>new Set(w.value)),_=(0,o.EW)(()=>new Set(D.value)),U=(0,o.EW)(()=>new Set(C.value)),Y=(0,o.EW)(()=>new Set(b.value));(0,o.nT)(()=>{if(O.value){const e=(0,s.cG)(O.value,{fieldNames:B.value});S.value=(0,t.A)({[c.$4]:c.c1},e.keyEntities)}});let z=!1;(0,o.wB)([()=>e.expandedKeys,()=>e.autoExpandParent,S],(l,a)=>{let[n,o]=l,[d,s]=a,u=m.value;if(void 0!==e.expandedKeys||z&&o!==s)u=e.autoExpandParent||!z&&e.defaultExpandParent?(0,r.hr)(e.expandedKeys,S.value):e.expandedKeys;else if(!z&&e.defaultExpandAll){const e=(0,t.A)({},S.value);delete e[c.$4],u=Object.keys(e).map(l=>e[l].key)}else!z&&e.defaultExpandedKeys&&(u=e.autoExpandParent||e.defaultExpandParent?(0,r.hr)(e.defaultExpandedKeys,S.value):e.defaultExpandedKeys);u&&(m.value=u),z=!0},{immediate:!0});const X=(0,v.IJ)([]);(0,o.nT)(()=>{X.value=(0,s.$9)(O.value,m.value,B.value)}),(0,o.nT)(()=>{e.selectable&&(void 0!==e.selectedKeys?x.value=(0,r.BE)(e.selectedKeys,e):!z&&e.defaultSelectedKeys&&(x.value=(0,r.BE)(e.defaultSelectedKeys,e)))});const{maxLevel:Z,levelEntities:q}=(0,k.A)(S);(0,o.nT)(()=>{if(e.checkable){let l;if(void 0!==e.checkedKeys?l=(0,r.tg)(e.checkedKeys)||{}:!z&&e.defaultCheckedKeys?l=(0,r.tg)(e.defaultCheckedKeys)||{}:O.value&&(l=(0,r.tg)(e.checkedKeys)||{checkedKeys:C.value,halfCheckedKeys:b.value}),l){let{checkedKeys:a=[],halfCheckedKeys:n=[]}=l;if(!e.checkStrictly){const e=(0,u.p)(a,!0,S.value,Z.value,q.value);({checkedKeys:a,halfCheckedKeys:n}=e)}C.value=a,b.value=n}}}),(0,o.nT)(()=>{e.loadedKeys&&(w.value=e.loadedKeys)});const Q=()=>{(0,t.A)(P,{dragOverNodeKey:null,dropPosition:null,dropLevelOffset:null,dropTargetKey:null,dropContainerKey:null,dropTargetPos:null,dropAllowed:!1})},V=e=>{$.value.scrollTo(e)};(0,o.wB)(()=>e.activeKey,()=>{void 0!==e.activeKey&&(L.value=e.activeKey)},{immediate:!0}),(0,o.wB)(L,e=>{(0,o.dY)(()=>{null!==e&&V({key:e})})},{immediate:!0,flush:"post"});const ee=l=>{void 0===e.expandedKeys&&(m.value=l)},le=()=>{null!==P.draggingNodeKey&&(0,t.A)(P,{draggingNodeKey:null,dropPosition:null,dropContainerKey:null,dropTargetKey:null,dropLevelOffset:null,dropAllowed:!0,dragOverNodeKey:null}),J=null,j=null},ae=(l,a)=>{const{onDragend:n}=e;P.dragOverNodeKey=null,le(),null===n||void 0===n||n({event:l,node:a.eventData}),M=null},ne=e=>{ae(e,null,!0),window.removeEventListener("dragend",ne)},te=(l,a)=>{const{onDragstart:n}=e,{eventKey:t,eventData:o}=a;M=a,J={x:l.clientX,y:l.clientY};const d=(0,r.BA)(m.value,t);P.draggingNodeKey=t,P.dragChildrenKeys=(0,r.kG)(t,S.value),E.value=$.value.getIndentWidth(),ee(d),window.addEventListener("dragend",ne),n&&n({event:l,node:o})},oe=(l,a)=>{const{onDragenter:n,onExpand:o,allowDrop:d,direction:s}=e,{pos:c,eventKey:u}=a;if(j!==u&&(j=u),!M)return void Q();const{dropPosition:i,dropLevelOffset:v,dropTargetKey:y,dropContainerKey:p,dropTargetPos:h,dropAllowed:K,dragOverNodeKey:g}=(0,r.Oh)(l,M,a,E.value,J,d,X.value,S.value,R.value,s);-1===P.dragChildrenKeys.indexOf(y)&&K?(A||(A={}),Object.keys(A).forEach(e=>{clearTimeout(A[e])}),M.eventKey!==a.eventKey&&(A[c]=window.setTimeout(()=>{if(null===P.draggingNodeKey)return;let e=m.value.slice();const n=S.value[a.eventKey];n&&(n.children||[]).length&&(e=(0,r.$s)(m.value,a.eventKey)),ee(e),o&&o(e,{node:a.eventData,expanded:!0,nativeEvent:l})},800)),M.eventKey!==y||0!==v?((0,t.A)(P,{dragOverNodeKey:g,dropPosition:i,dropLevelOffset:v,dropTargetKey:y,dropContainerKey:p,dropTargetPos:h,dropAllowed:K}),n&&n({event:l,node:a.eventData,expandedKeys:m.value})):Q()):Q()},de=(l,a)=>{const{onDragover:n,allowDrop:o,direction:d}=e;if(!M)return;const{dropPosition:s,dropLevelOffset:c,dropTargetKey:u,dropContainerKey:i,dropAllowed:v,dropTargetPos:y,dragOverNodeKey:p}=(0,r.Oh)(l,M,a,E.value,J,o,X.value,S.value,R.value,d);-1===P.dragChildrenKeys.indexOf(u)&&v&&(M.eventKey===u&&0===c?null===P.dropPosition&&null===P.dropLevelOffset&&null===P.dropTargetKey&&null===P.dropContainerKey&&null===P.dropTargetPos&&!1===P.dropAllowed&&null===P.dragOverNodeKey||Q():s===P.dropPosition&&c===P.dropLevelOffset&&u===P.dropTargetKey&&i===P.dropContainerKey&&y===P.dropTargetPos&&v===P.dropAllowed&&p===P.dragOverNodeKey||(0,t.A)(P,{dropPosition:s,dropLevelOffset:c,dropTargetKey:u,dropContainerKey:i,dropTargetPos:y,dropAllowed:v,dragOverNodeKey:p}),n&&n({event:l,node:a.eventData}))},re=(l,a)=>{j!==a.eventKey||l.currentTarget.contains(l.relatedTarget)||(Q(),j=null);const{onDragleave:n}=e;n&&n({event:l,node:a.eventData})},se=function(l,a){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var o;const{dragChildrenKeys:d,dropPosition:c,dropTargetKey:u,dropTargetPos:i,dropAllowed:y}=P;if(!y)return;const{onDrop:p}=e;if(P.dragOverNodeKey=null,le(),null===u)return;const K=(0,t.A)((0,t.A)({},(0,s.N5)(u,(0,v.ux)(H.value))),{active:(null===(o=Ce.value)||void 0===o?void 0:o.key)===u,data:S.value[u].node}),g=-1!==d.indexOf(u);(0,h.$e)(!g,"Can not drop to dragNode's children node. Maybe this is a bug of ant-design-vue. Please report an issue.");const f=(0,r.LI)(i),k={event:l,node:(0,s.Hj)(K),dragNode:M?M.eventData:null,dragNodesKeys:[M.eventKey].concat(d),dropToGap:0!==c,dropPosition:c+Number(f[f.length-1])};n||null===p||void 0===p||p(k),M=null},ce=(e,l)=>{const{expanded:a,key:n}=l,o=X.value.filter(e=>e.key===n)[0],d=(0,s.Hj)((0,t.A)((0,t.A)({},(0,s.N5)(n,H.value)),{data:o.data}));ee(a?(0,r.BA)(m.value,n):(0,r.$s)(m.value,n)),Ne(e,d)},ue=(l,a)=>{const{onClick:n,expandAction:t}=e;"click"===t&&ce(l,a),n&&n(l,a)},ie=(l,a)=>{const{onDblclick:n,expandAction:t}=e;"doubleclick"!==t&&"dblclick"!==t||ce(l,a),n&&n(l,a)},ve=(l,a)=>{let n=x.value;const{onSelect:t,multiple:o}=e,{selected:d}=a,s=a[B.value.key],c=!d;n=c?o?(0,r.$s)(n,s):[s]:(0,r.BA)(n,s);const u=S.value,i=n.map(e=>{const l=u[e];return l?l.node:null}).filter(e=>e);void 0===e.selectedKeys&&(x.value=n),t&&t(n,{event:"select",selected:c,node:a,selectedNodes:i,nativeEvent:l})},ye=(l,a,n)=>{const{checkStrictly:t,onCheck:o}=e,d=a[B.value.key];let s;const c={event:"check",node:a,checked:n,nativeEvent:l},i=S.value;if(t){const l=n?(0,r.$s)(C.value,d):(0,r.BA)(C.value,d),a=(0,r.BA)(b.value,d);s={checked:l,halfChecked:a},c.checkedNodes=l.map(e=>i[e]).filter(e=>e).map(e=>e.node),void 0===e.checkedKeys&&(C.value=l)}else{let{checkedKeys:l,halfCheckedKeys:a}=(0,u.p)([...C.value,d],!0,i,Z.value,q.value);if(!n){const e=new Set(l);e.delete(d),({checkedKeys:l,halfCheckedKeys:a}=(0,u.p)(Array.from(e),{checked:!1,halfCheckedKeys:a},i,Z.value,q.value))}s=l,c.checkedNodes=[],c.checkedNodesPositions=[],c.halfCheckedKeys=a,l.forEach(e=>{const l=i[e];if(!l)return;const{node:a,pos:n}=l;c.checkedNodes.push(a),c.checkedNodesPositions.push({node:a,pos:n})}),void 0===e.checkedKeys&&(C.value=l,b.value=a)}o&&o(s,c)},pe=l=>{const a=l[B.value.key],n=new Promise((n,t)=>{const{loadData:o,onLoad:d}=e;if(!o||G.value.has(a)||_.value.has(a))return null;const s=o(l);s.then(()=>{const t=(0,r.$s)(w.value,a),o=(0,r.BA)(D.value,a);d&&d(t,{event:"load",node:l}),void 0===e.loadedKeys&&(w.value=t),D.value=o,n()}).catch(l=>{const o=(0,r.BA)(D.value,a);if(D.value=o,T[a]=(T[a]||0)+1,T[a]>=N){(0,h.$e)(!1,"Retry for `loadData` many times but still failed. No more retry.");const l=(0,r.$s)(w.value,a);void 0===e.loadedKeys&&(w.value=l),n()}t(l)}),D.value=(0,r.$s)(D.value,a)});return n.catch(()=>{}),n},he=(l,a)=>{const{onMouseenter:n}=e;n&&n({event:l,node:a})},Ke=(l,a)=>{const{onMouseleave:n}=e;n&&n({event:l,node:a})},ge=(l,a)=>{const{onRightClick:n}=e;n&&(l.preventDefault(),n({event:l,node:a}))},fe=l=>{const{onFocus:a}=e;I.value=!0,a&&a(l)},ke=l=>{const{onBlur:a}=e;I.value=!1,xe(null),a&&a(l)},Ne=(l,a)=>{let n=m.value;const{onExpand:t,loadData:o}=e,{expanded:d}=a,s=a[B.value.key];if(W.value)return;const c=n.indexOf(s),u=!d;if((0,h.$e)(d&&-1!==c||!d&&-1===c,"Expand state not sync with index check"),n=u?(0,r.$s)(n,s):(0,r.BA)(n,s),ee(n),t&&t(n,{node:a,expanded:u,nativeEvent:l}),u&&o){const e=pe(a);e&&e.then(()=>{}).catch(e=>{const l=(0,r.BA)(m.value,s);ee(l),Promise.reject(e)})}},Ae=()=>{W.value=!0},Ee=()=>{setTimeout(()=>{W.value=!1})},xe=l=>{const{onActiveChange:a}=e;L.value!==l&&(void 0!==e.activeKey&&(L.value=l),null!==l&&V({key:l}),a&&a(l))},Ce=(0,o.EW)(()=>null===L.value?null:X.value.find(e=>{let{key:l}=e;return l===L.value})||null),be=e=>{let l=X.value.findIndex(e=>{let{key:l}=e;return l===L.value});-1===l&&e<0&&(l=X.value.length),l=(l+e+X.value.length)%X.value.length;const a=X.value[l];if(a){const{key:e}=a;xe(e)}else xe(null)},we=(0,o.EW)(()=>(0,s.Hj)((0,t.A)((0,t.A)({},(0,s.N5)(L.value,H.value)),{data:Ce.value.data,active:!0}))),De=l=>{const{onKeydown:a,checkable:n,selectable:t}=e;switch(l.which){case K.A.UP:be(-1),l.preventDefault();break;case K.A.DOWN:be(1),l.preventDefault();break}const o=Ce.value;if(o&&o.data){const e=!1===o.data.isLeaf||!!(o.data.children||[]).length,a=we.value;switch(l.which){case K.A.LEFT:e&&R.value.has(L.value)?Ne({},a):o.parent&&xe(o.parent.key),l.preventDefault();break;case K.A.RIGHT:e&&!R.value.has(L.value)?Ne({},a):o.children&&o.children.length&&xe(o.children[0].key),l.preventDefault();break;case K.A.ENTER:case K.A.SPACE:!n||a.disabled||!1===a.checkable||a.disableCheckbox?n||!t||a.disabled||!1===a.selectable||ve({},a):ye({},a,!U.value.has(L.value));break}}a&&a(l)};return y({onNodeExpand:Ne,scrollTo:V,onKeydown:De,selectedKeys:(0,o.EW)(()=>x.value),checkedKeys:(0,o.EW)(()=>C.value),halfCheckedKeys:(0,o.EW)(()=>b.value),loadedKeys:(0,o.EW)(()=>w.value),loadingKeys:(0,o.EW)(()=>D.value),expandedKeys:(0,o.EW)(()=>m.value)}),(0,o.hi)(()=>{window.removeEventListener("dragend",ne),p.value=!0}),(0,d._3)({expandedKeys:m,selectedKeys:x,loadedKeys:w,loadingKeys:D,checkedKeys:C,halfCheckedKeys:b,expandedKeysSet:R,selectedKeysSet:F,loadedKeysSet:G,loadingKeysSet:_,checkedKeysSet:U,halfCheckedKeysSet:Y,flattenNodes:X}),()=>{const{draggingNodeKey:l,dropLevelOffset:r,dropContainerKey:s,dropTargetKey:u,dropPosition:v,dragOverNodeKey:y}=P,{prefixCls:p,showLine:h,focusable:K,tabindex:k=0,selectable:N,showIcon:A,icon:x=i.icon,switcherIcon:C,draggable:b,checkable:w,checkStrictly:D,disabled:m,motion:T,loadData:O,filterTreeNode:W,height:B,itemHeight:J,virtual:M,dropIndicatorRender:j,onContextmenu:H,onScroll:R,direction:F,rootClassName:G,rootStyle:_}=e,{class:U,style:Y}=a,z=(0,f.A)((0,t.A)((0,t.A)({},e),a),{aria:!0,data:!0});let X;return X=!!b&&("object"===typeof b?b:"function"===typeof b?{nodeDraggable:b}:{}),(0,o.bF)(d.Uz,{value:{prefixCls:p,selectable:N,showIcon:A,icon:x,switcherIcon:C,draggable:X,draggingNodeKey:l,checkable:w,customCheckable:i.checkable,checkStrictly:D,disabled:m,keyEntities:S.value,dropLevelOffset:r,dropContainerKey:s,dropTargetKey:u,dropPosition:v,dragOverNodeKey:y,dragging:null!==l,indent:E.value,direction:F,dropIndicatorRender:j,loadData:O,filterTreeNode:W,onNodeClick:ue,onNodeDoubleClick:ie,onNodeExpand:Ne,onNodeSelect:ve,onNodeCheck:ye,onNodeLoad:pe,onNodeMouseEnter:he,onNodeMouseLeave:Ke,onNodeContextMenu:ge,onNodeDragStart:te,onNodeDragEnter:oe,onNodeDragOver:de,onNodeDragLeave:re,onNodeDragEnd:ae,onNodeDrop:se,slots:i}},{default:()=>[(0,o.bF)("div",{role:"tree",class:(0,g.A)(p,U,G,{[`${p}-show-line`]:h,[`${p}-focused`]:I.value,[`${p}-active-focused`]:null!==L.value}),style:_},[(0,o.bF)(c.Ay,(0,n.A)({ref:$,prefixCls:p,style:Y,disabled:m,selectable:N,checkable:!!w,motion:T,height:B,itemHeight:J,virtual:M,focusable:K,focused:I.value,tabindex:k,activeItem:Ce.value,onFocus:fe,onBlur:ke,onKeydown:De,onActiveChange:xe,onListChangeStart:Ae,onListChangeEnd:Ee,onContextmenu:H,onScroll:R},z),null)])]})}}})}}]);
//# sourceMappingURL=vendors-55eaa404.d77690e1.js.map